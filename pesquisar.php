<?php
require_once 'services/movie.php';
require_once 'utils/movie.php';

$search = $_GET['search'];

$result = searchMovie($search);
$success = $result[0];
$data;

if ($success) {
  $data = $result[1]->results;
} else {
  $data = $result[1];
}
?>

<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://unpkg.com/@phosphor-icons/web"></script>

  <link rel="stylesheet" href="styles/global.css">
  <link rel="stylesheet" href="styles/pesquisar.css">

  <title>
    <?php
    if ($success) {
      echo count($data) . " filmes encontrados";
    } else {
      echo $data;
    }
    ?>
  </title>
</head>

<body class="body">
  <div class="background-plane">
    <img class="img" src="https://image.tmdb.org/t/p/w300/9Xcg7Ar4ketv4rl8yeK32yp9zQA.jpg">
    <div></div>
  </div>

  <?php require_once 'components/Header.php' ?>

  <span class="">Mostrando resultados para <span class="italic">"<?php echo $search; ?>"</span></span>

  <div class="movie-grid">
    <?php
    if (count($data) === 0) {
      echo '
        <span>
          Nenhum filme encontrado.
        </span>
      ';
    } else {
      foreach ($data as $movie) {
        echo '
          <a href="filme.php?movieId=' . $movie->id . '" class="movie-card">
            <img src="' . makeMoviePoster($movie->poster_path) . '">
            <span class="body-text">' . $movie->title . '</span>
          </a>
        ';
      }
    }
    ?>
  </div>
</body>

</html>